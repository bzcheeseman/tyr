git:
  depth: 1
  quiet: true

language: c++

os: osx
osx_image: xcode10.1
addons:
  homebrew:
    packages:
      - llvm
      - cmake
      - python
    update: true

env:
  - PATH="/usr/local/opt/llvm/bin:${PATH}"

jobs:
  include:
    - stage: build
      script: mkdir -p build && cd build && cmake .. -DCMAKE_INSTALL_PREFIX=../test -DBUILD_INTEGRATION_TESTS=OFF && make check install
    - stage: test
      script: cd build && cmake .. -DBUILD_INTEGRATION_TESTS=ON && make c_test && make python_test && make x_lang_test

